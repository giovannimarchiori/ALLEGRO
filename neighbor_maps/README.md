# Recipes to update the neighbor maps for topo clustering

The maps can be generated by executing the neighbours.py script with

`k4run neighbours.py`

One can configure which detectors to include in the map via command line options.

For debugging, i.e. to compare two map files (number of entries and content), the script compareMaps.py in ../utils can be used

The script uses the CreateFCCeeCaloNeighbours algorithm implemented in [CreateFCCeeCaloNeighbours.h](https://github.com/HEP-FCC/k4RecCalorimeter/blob/main/RecFCCeeCalorimeter/src/components/CreateFCCeeCaloNeighbours.h) and [CreateFCCeeCaloNeighbours.cpp](https://github.com/HEP-FCC/k4RecCalorimeter/blob/main/RecFCCeeCalorimeter/src/components/CreateFCCeeCaloNeighbours.cpp).
The algorithm itself relies on the methods returning number of cells and neighbour lists within a given readout for the various segmentation classes (https://github.com/key4hep/k4geo/blob/main/detectorCommon/src/DetUtils_k4geo.cpp) and some additional logic to find neighbours among different segmentations (e.g. barrel vs endcap, or ecal vs hcal).


## Barrel

## Endcap

